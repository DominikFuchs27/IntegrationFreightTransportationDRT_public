import csv
import numpy
import pickle
import pandas
import CallMatrix

def GetDuration(origin, destination):   # Calculates the duration between an origin and destination node
    if origin.__contains__('.'):    # remove the index of the nodes if it is part of a route (e.g. 9000.1)
        origin = origin.split('.', 1)[0]
        destination = destination.split('.')[0]
    nodes_duration = ['test', '', '', '9000', '9345', '9349', '9353', '9354', '9357', '9359', '9361', '9363', '9379',
                      '9380', '9381', '9382', '9385', '9386', '9388', '9393', '9394', '9397', '9398', '9400', '9401',
                      '9403', '9405', '9407', '9409', '9410', '9413', '9414', '9417', '9418', '9419', '9420', '9421',
                      '9422', '9424', '9425', '9426', '9427', '9428', '9429', '9430', '9431', '9435', '9439', '9440',
                      '9441', '9442', '9443', '9445', '9447', '9448', '9450', '9451', '9452', '9453', '9455', '9456',
                      '9457', '9458', '9459', '9460', '9461', '9462', '9465', '9468', '9470', '9471', '9473', '9474',
                      '9475', '9477', '9478', '9479', '9480', '9484', '9485', '9486', '9487', '9488', '9489', '9491',
                      '9492', '9493', '9510', '9519', '9524', '9526', '9527', '9531', '9532', '9558', '9573', '9584',
                      '9586', '9596', '9604', '9611', '9613', '9620', '9621', '9625', '9635', '9639', '9641', '9642',
                      '9649', '9655', '9656', '9661', '9664', '9666', '9668', '9670', '9671', '9833', '9834', '9837',
                      '9848', '10851', '10852', '10857', '10859', '10861', '10866', '10873', '10879', '10880', '10883',
                      '10888', '10889', '10896', '10906', '10923', '10936', '10943', '10966', '10978', '10986', '10989',
                      '10991', '10993', '10995', '10996', '10999', '11000', '11002', '11005', '11007', '11009', '11010',
                      '12214', '12839', '12868', '12892', '12895', '12901', '12939', '1000', '1001', '1002', '1003',
                      '1004', '1005', '1006', '1007', '1008', '1009', '1010', '1011', '1012', '1013', '1014', '1015',
                      '1016', '1017']
    origin = str(origin)
    destination = str(destination)
    if len(origin) < 4:
        print("lol")
    origin_index = nodes_duration.index(origin)
    destination_index = nodes_duration.index(destination)
    duration_outcome = round(float(CallMatrix.Duration_Matrix[origin_index][destination_index])/60)  # Retrieve values from function CallMatrix
    return duration_outcome


def GetDistance(origin,destination):        # Calculates the distance between an origin and destination node
    if origin.__contains__('.'):             # remove the index of the nodes if it is part of a route (e.g. 9000.1)
        origin = origin.split('.', 1)[0]
        destination = destination.split('.')[0]
    nodes_distance = ['Test', '', '', '9000', '9345', '9349', '9353', '9354', '9357', '9359', '9361', '9363', '9379', '9380', '9381', '9382', '9385', '9386', '9388', '9393', '9394', '9397', '9398', '9400', '9401', '9403', '9405', '9407', '9409', '9410', '9413', '9414', '9417', '9418', '9419', '9420', '9421', '9422', '9424', '9425', '9426', '9427', '9428', '9429', '9430', '9431', '9435', '9439', '9440', '9441', '9442', '9443', '9445', '9447', '9448', '9450', '9451', '9452', '9453', '9455', '9456', '9457', '9458', '9459', '9460', '9461', '9462', '9465', '9468', '9470', '9471', '9473', '9474', '9475', '9477', '9478', '9479', '9480', '9484', '9485', '9486', '9487', '9488', '9489', '9491', '9492', '9493', '9510', '9519', '9524', '9526', '9527', '9531', '9532', '9558', '9573', '9584', '9586', '9596', '9604', '9611', '9613', '9620', '9621', '9625', '9635', '9639', '9641', '9642', '9649', '9655', '9656', '9661', '9664', '9666', '9668', '9670', '9671', '9833', '9834', '9837', '9848', '10851', '10852', '10857', '10859', '10861', '10866', '10873', '10879', '10880', '10883', '10888', '10889', '10896', '10906', '10923', '10936', '10943', '10966', '10978', '10986', '10989', '10991', '10993', '10995', '10996', '10999', '11000', '11002', '11005', '11007', '11009', '11010', '12214', '12839', '12868', '12892', '12895', '12901', '12939', '1000', '1001', '1002', '1003', '1004', '1005', '1006', '1007', '1008', '1009', '1010', '1011', '1012', '1013', '1014', '1015', '1016', '1017']
    origin_index = nodes_distance.index(origin)
    destination_index = nodes_distance.index(destination)
    distance_outcome = float(CallMatrix.Distance_Matrix[origin_index][destination_index])     # Retrieve values from function CallMatrix
    return distance_outcome
